

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tardis.io.logger.logger &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../../../../_static/tardis_logo.ico"/>
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=073209f4"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.13/dist/embed-amd.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href="../../../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            tardis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../resources/credits.html">Credits &amp; Publication Policies</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/high_energy/run_high_energy_workflow.html">TARDIS High Energy Workflow Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../analyzing_tardis/visualization/tutorial_montecarlo_packet_visualization.html">Montecarlo Packet Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../analyzing_tardis/index.html">Analyszing TARDIS Simulation Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/configuration/tutorial_read_configuration.html">Reading a Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/output/index.html">Additional Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how-to/code_comparison/index.html">How to do Code Comparison using TARDIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics_walkthrough/intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics_walkthrough/setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics_walkthrough/montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics_walkthrough/update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics_walkthrough/spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../physics_walkthrough/tardisgamma/index.html">TARDIS-High Energy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/visualization_reference.html">Visualization Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/configuration/index.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../io/hdf/index.html">Hierarchical Data Format (HDF5) Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../resources/zreferences.html">Bibliography and Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing/in_progress/index.html">Features In-Progress</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">tardis.io.logger.logger</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for tardis.io.logger.logger</h1><div class="highlight"><pre>
<span></span>import logging
import sys
from dataclasses import dataclass, field
import panel as pn
from IPython.display import display
import pandas as pd
from tardis.io.logger.colored_logger import ColoredFormatter
from tardis.util.environment import Environment
from tardis.io.logger.logger_widget import create_logger_columns, PanelWidgetLogHandler
import tardis.util.panel_init as panel_init
panel_init.auto()

PYTHON_WARNINGS_LOGGER = logging.getLogger(&quot;py.warnings&quot;)

logger = logging.getLogger(__name__)

<div class="viewcode-block" id="LoggingConfig">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.LoggingConfig">[docs]</a>
@dataclass
class LoggingConfig:
    &quot;&quot;&quot;Logging configuration.
    
    Attributes
    ----------
    LEVELS : dict
        The logging levels.
    COLORS : dict
        The logging colors.
    DEFAULT_LEVEL : str
        The default logging level.
    DEFAULT_SPECIFIC_STATE : bool
        The default specific log level state.
    &quot;&quot;&quot;
    LEVELS: dict = field(default_factory=lambda: {
        &quot;NOTSET&quot;: logging.NOTSET,
        &quot;DEBUG&quot;: logging.DEBUG,
        &quot;INFO&quot;: logging.INFO,
        &quot;WARNING&quot;: logging.WARNING,
        &quot;ERROR&quot;: logging.ERROR,
        &quot;CRITICAL&quot;: logging.CRITICAL,
    })

    COLORS: dict = field(default_factory=lambda: {
        logging.INFO: &quot;#D3D3D3&quot;,
        logging.WARNING: &quot;orange&quot;,
        logging.ERROR: &quot;red&quot;,
        logging.CRITICAL: &quot;orange&quot;,
        logging.DEBUG: &quot;blue&quot;,
        &quot;default&quot;: &quot;black&quot;,
    })

    DEFAULT_LEVEL = &quot;INFO&quot;
    DEFAULT_SPECIFIC_STATE = False</div>


LOGGING_LEVELS = LoggingConfig().LEVELS

<div class="viewcode-block" id="TARDISLogger">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.TARDISLogger">[docs]</a>
class TARDISLogger:
    &quot;&quot;&quot;Main logger class for TARDIS.
    
    Parameters
    ----------
    log_columns : dict
        Dictionary of scroll columns for each log level.
    display_handles : dict, optional
        Dictionary of display handles for each column (jupyter environment).
    &quot;&quot;&quot;
    def __init__(self, log_columns=None, display_handles=None, batch_size=10):
        self.config = LoggingConfig()
        self.logger = logging.getLogger(&quot;tardis&quot;)
        self.log_columns = log_columns
        self.display_handles = display_handles
        self.display_ids = {}
        self.batch_size = batch_size

<div class="viewcode-block" id="TARDISLogger.configure_logging">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.TARDISLogger.configure_logging">[docs]</a>
    def configure_logging(self, log_level, tardis_config, specific_log_level=None):
        &quot;&quot;&quot;Configure the logging level and filtering for TARDIS loggers.
        
        Parameters
        ----------
        log_level : str
            The logging level to use (e.g., &quot;INFO&quot;, &quot;DEBUG&quot;).
        tardis_config : dict
            Configuration dictionary containing debug settings.
        specific_log_level : bool, optional
            Whether to enable specific log level filtering.
            
        Raises
        ------
        ValueError
            If an invalid log_level is provided.
        &quot;&quot;&quot;
        if &quot;debug&quot; in tardis_config:
            specific_log_level = tardis_config[&quot;debug&quot;].get(
                &quot;specific_log_level&quot;, specific_log_level
            )
            logging_level = log_level or tardis_config[&quot;debug&quot;].get(
                &quot;log_level&quot;, &quot;INFO&quot;
            )
            if log_level and tardis_config[&quot;debug&quot;].get(&quot;log_level&quot;):
                self.logger.debug(
                    &quot;log_level is defined both in Functional Argument &amp; YAML Configuration {debug section}, &quot;
                    f&quot;log_level = {log_level.upper()} will be used for Log Level Determination&quot;
                )
        else:
            tardis_config[&quot;debug&quot;] = {}
            logging_level = log_level or self.config.DEFAULT_LEVEL
            specific_log_level = specific_log_level or self.config.DEFAULT_SPECIFIC_STATE

        logging_level = logging_level.upper()
        if logging_level not in self.config.LEVELS:
            raise ValueError(
                f&quot;Passed Value for log_level = {logging_level} is Invalid. Must be one of the following {list(self.config.LEVELS.keys())}&quot;
            )

        logger = logging.getLogger(&quot;tardis&quot;)
        tardis_loggers = [
            logging.getLogger(name)
            for name in logging.root.manager.loggerDict
            if name.startswith(&quot;tardis&quot;)
        ]

        if logging_level in self.config.LEVELS:
            for logger in tardis_loggers:
                logger.setLevel(self.config.LEVELS[logging_level])

        if logger.filters:
            for filter in logger.filters:
                for logger in tardis_loggers:
                    logger.removeFilter(filter)

        if specific_log_level:
            filter_log = LogFilter([self.config.LEVELS[logging_level], logging.INFO, logging.DEBUG])
            for logger in tardis_loggers:
                logger.addFilter(filter_log)
        else:
            for filter in logger.filters:
                for logger in tardis_loggers:
                    logger.removeFilter(filter)</div>


<div class="viewcode-block" id="TARDISLogger.setup_widget_logging">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.TARDISLogger.setup_widget_logging">[docs]</a>
    def setup_widget_logging(self, display_widget=True):
        &quot;&quot;&quot;Set up widget-based logging interface.

        Parameters
        ----------
        display_widget : bool, optional
            Whether to display the widget in GUI environments. Default is True.
        &quot;&quot;&quot;
        self.widget_handler = PanelWidgetLogHandler(
            log_columns=self.log_columns,
            colors=self.config.COLORS,
            display_widget=display_widget,
            display_handles=self.display_handles,
            batch_size=self.batch_size
        )
        self.widget_handler.setFormatter(
            logging.Formatter(&quot;%(name)s [%(levelname)s] %(message)s (%(filename)s:%(lineno)d)&quot;)
        )

        self._configure_handlers()</div>


    def _configure_handlers(self):
        &quot;&quot;&quot;Configure logging handlers.
        
        Removes existing handlers and adds the widget handler to the
        TARDIS logger and Python warnings logger.
        &quot;&quot;&quot;
        logging.captureWarnings(True)

        for logger in [self.logger, logging.getLogger()]:
            for handler in logger.handlers[:]:
                logger.removeHandler(handler)

        self.logger.addHandler(self.widget_handler)
        PYTHON_WARNINGS_LOGGER.addHandler(self.widget_handler)
    
<div class="viewcode-block" id="TARDISLogger.finalize_widget_logging">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.TARDISLogger.finalize_widget_logging">[docs]</a>
    def finalize_widget_logging(self):
        &quot;&quot;&quot;Finalize widget logging by embedding the final state.
        &quot;&quot;&quot;
        # Embed the final state for Jupyter environments
        if (Environment.is_notebook() and hasattr(self, &#39;display_handles&#39;) 
            and hasattr(self, &#39;display_ids&#39;) and self.display_handles and self.display_ids):
            print(&quot;Embedding the final state for Jupyter environments&quot;)
            for level, column in self.log_columns.items():
                if (level in self.display_handles and level in self.display_ids 
                    and self.display_handles[level] is not None):
                    self.display_handles[level].update(column.embed())</div>

    
<div class="viewcode-block" id="TARDISLogger.remove_widget_handler">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.TARDISLogger.remove_widget_handler">[docs]</a>
    def remove_widget_handler(self):
        &quot;&quot;&quot;Remove the widget handler from the logger.
        &quot;&quot;&quot;
        self.logger.removeHandler(self.widget_handler)
        PYTHON_WARNINGS_LOGGER.removeHandler(self.widget_handler)
        self.widget_handler.close()</div>

        
<div class="viewcode-block" id="TARDISLogger.setup_stream_handler">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.TARDISLogger.setup_stream_handler">[docs]</a>
    def setup_stream_handler(self):
        &quot;&quot;&quot;Set up notebook-based logging after widget handler is removed.
        &quot;&quot;&quot;
        stream_handler = logging.StreamHandler(sys.stdout)
        stream_handler.setFormatter(ColoredFormatter())
        
        self.logger.addHandler(stream_handler)
        PYTHON_WARNINGS_LOGGER.addHandler(stream_handler)</div>
</div>


<div class="viewcode-block" id="LogFilter">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.LogFilter">[docs]</a>
class LogFilter:
    &quot;&quot;&quot;Filter for controlling which log levels are displayed.
    
    Parameters
    ----------
    log_levels : list
        List of logging levels to allow through the filter.
    &quot;&quot;&quot;
    def __init__(self, log_levels):
        self.log_levels = log_levels

<div class="viewcode-block" id="LogFilter.filter">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.LogFilter.filter">[docs]</a>
    def filter(self, log_record):
        &quot;&quot;&quot;Determine if a log record should be displayed.
        
        Parameters
        ----------
        log_record : logging.LogRecord
            The log record to evaluate.
            
        Returns
        -------
        bool
            True if the record&#39;s level is in the allowed levels, False otherwise.
        &quot;&quot;&quot;
        return log_record.levelno in self.log_levels</div>
</div>


<div class="viewcode-block" id="logging_state">
<a class="viewcode-back" href="../../../../api/tardis.io.logger.logger.html#tardis.io.logger.logger.logging_state">[docs]</a>
def logging_state(log_level, tardis_config, specific_log_level=None, display_logging_widget=True, widget_start_height=10, widget_max_height=300, batch_size=10):
    &quot;&quot;&quot;Configure and initialize the TARDIS logging system.
    
    Parameters
    ----------
    log_level : str
        The logging level to use (e.g., &quot;INFO&quot;, &quot;DEBUG&quot;).
    tardis_config : dict
        Configuration dictionary containing debug settings.
    specific_log_level : bool, optional
        Whether to enable specific log level filtering.
    display_logging_widget : bool, optional
        Whether to display the logging widget. Default is True.
    widget_start_height : int, optional
        Starting height for widget columns. Default is 10.
    widget_max_height : int, optional
        Maximum height for widget columns. Default is 300.
    batch_size : int, optional
        Number of logs to batch before updating widget. Default is 10.
        
    Returns
    -------
    dict
        Dictionary of log columns if display_logging_widget is True, otherwise None.
    &quot;&quot;&quot;
    log_columns = create_logger_columns(start_height=widget_start_height, max_height=widget_max_height)
    tardislogger = TARDISLogger(log_columns=log_columns, batch_size=batch_size)
    tardislogger.configure_logging(log_level, tardis_config, specific_log_level)
    use_widget = display_logging_widget and (Environment.is_notebook() or Environment.is_vscode() or Environment.is_sshjh())
    
    if Environment.is_notebook() or Environment.is_sshjh():
        display_handles = {}
        display_ids = {}
        for level, column in log_columns.items():
            display_id = f&quot;logger_column_{level.lower().replace(&#39;/&#39;, &#39;_&#39;)}&quot;
            display_handles[level] = display(column, display_id=display_id)
            display_ids[level] = display_id
        
        # Update tardislogger with display handles and IDs
        tardislogger.display_handles = display_handles
        tardislogger.display_ids = display_ids
    elif Environment.is_vscode():
        # Use direct display for vscode (no change)
        for level, column in log_columns.items():
            display(column)
    elif Environment.is_terminal():
        logger.warning(&quot;Terminal environment detected, skipping logger widget&quot;)
    else:
        logger.warning(&quot;Unknown environment, skipping logger widget&quot;)

    # Setup widget logging once after display handles are configured
    tardislogger.setup_widget_logging(display_widget=display_logging_widget)
    
    if use_widget:
        return log_columns, tardislogger
    else:
        return None, tardislogger</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 24 Aug 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>