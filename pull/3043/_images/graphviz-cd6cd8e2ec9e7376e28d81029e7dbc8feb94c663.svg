<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 11.0.0 (20240519.1550)
 -->
<!-- Pages: 1 -->
<svg width="443pt" height="783pt"
 viewBox="0.00 0.00 442.50 783.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 779)">
<polygon fill="white" stroke="none" points="-4,4 -4,-779 438.5,-779 438.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M329.5,-775C329.5,-775 299.5,-775 299.5,-775 293.5,-775 287.5,-769 287.5,-763 287.5,-763 287.5,-751 287.5,-751 287.5,-745 293.5,-739 299.5,-739 299.5,-739 329.5,-739 329.5,-739 335.5,-739 341.5,-745 341.5,-751 341.5,-751 341.5,-763 341.5,-763 341.5,-769 335.5,-775 329.5,-775"/>
<text text-anchor="middle" x="314.5" y="-753.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Start</text>
</g>
<!-- allpacketsprocessed -->
<g id="node3" class="node">
<title>allpacketsprocessed</title>
<polygon fill="none" stroke="black" points="314.5,-703 248.25,-671 314.5,-639 380.75,-671 314.5,-703"/>
<text text-anchor="middle" x="314.5" y="-673.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">All packets</text>
<text text-anchor="middle" x="314.5" y="-661.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">processed?</text>
</g>
<!-- start&#45;&gt;allpacketsprocessed -->
<g id="edge1" class="edge">
<title>start&#45;&gt;allpacketsprocessed</title>
<path fill="none" stroke="black" d="M314.5,-738.6C314.5,-731.59 314.5,-723.18 314.5,-714.73"/>
<polygon fill="black" stroke="black" points="318,-714.82 314.5,-704.82 311,-714.82 318,-714.82"/>
</g>
<!-- end -->
<g id="node2" class="node">
<title>end</title>
<path fill="none" stroke="black" d="M235.5,-591C235.5,-591 205.5,-591 205.5,-591 199.5,-591 193.5,-585 193.5,-579 193.5,-579 193.5,-567 193.5,-567 193.5,-561 199.5,-555 205.5,-555 205.5,-555 235.5,-555 235.5,-555 241.5,-555 247.5,-561 247.5,-567 247.5,-567 247.5,-579 247.5,-579 247.5,-585 241.5,-591 235.5,-591"/>
<text text-anchor="middle" x="220.5" y="-569.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">End</text>
</g>
<!-- allpacketsprocessed&#45;&gt;end -->
<g id="edge3" class="edge">
<title>allpacketsprocessed&#45;&gt;end</title>
<path fill="none" stroke="black" d="M293.64,-648.69C279.4,-634.15 260.47,-614.82 245.43,-599.46"/>
<polygon fill="black" stroke="black" points="248.09,-597.18 238.6,-592.48 243.09,-602.07 248.09,-597.18"/>
<text text-anchor="middle" x="272.38" y="-611.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- nextpacket -->
<g id="node7" class="node">
<title>nextpacket</title>
<path fill="none" stroke="black" d="M351.38,-591C351.38,-591 277.62,-591 277.62,-591 271.62,-591 265.62,-585 265.62,-579 265.62,-579 265.62,-567 265.62,-567 265.62,-561 271.62,-555 277.62,-555 277.62,-555 351.38,-555 351.38,-555 357.38,-555 363.38,-561 363.38,-567 363.38,-567 363.38,-579 363.38,-579 363.38,-585 357.38,-591 351.38,-591"/>
<text text-anchor="middle" x="314.5" y="-575.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Select next packet</text>
<text text-anchor="middle" x="314.5" y="-563.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">from pool</text>
</g>
<!-- allpacketsprocessed&#45;&gt;nextpacket -->
<g id="edge2" class="edge">
<title>allpacketsprocessed&#45;&gt;nextpacket</title>
<path fill="none" stroke="black" d="M314.5,-638.57C314.5,-627.08 314.5,-614.15 314.5,-602.9"/>
<polygon fill="black" stroke="black" points="318,-603.01 314.5,-593.01 311,-603.01 318,-603.01"/>
<text text-anchor="middle" x="319.75" y="-611.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- shortestdistance -->
<g id="node4" class="node">
<title>shortestdistance</title>
<polygon fill="none" stroke="black" points="221.5,-372 137.25,-340 221.5,-308 305.75,-340 221.5,-372"/>
<text text-anchor="middle" x="221.5" y="-342.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Distance to cell</text>
<text text-anchor="middle" x="221.5" y="-330.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">edge shortest?</text>
</g>
<!-- outeredge -->
<g id="node5" class="node">
<title>outeredge</title>
<polygon fill="none" stroke="black" points="314.5,-260 222.75,-228 314.5,-196 406.25,-228 314.5,-260"/>
<text text-anchor="middle" x="314.5" y="-230.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Escaping through</text>
<text text-anchor="middle" x="314.5" y="-218.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">surface?</text>
</g>
<!-- shortestdistance&#45;&gt;outeredge -->
<g id="edge7" class="edge">
<title>shortestdistance&#45;&gt;outeredge</title>
<path fill="none" stroke="black" d="M241.68,-315.13C254.87,-299.53 272.28,-278.94 286.77,-261.8"/>
<polygon fill="black" stroke="black" points="289.28,-264.25 293.06,-254.36 283.93,-259.73 289.28,-264.25"/>
<text text-anchor="middle" x="278.38" y="-280.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- interact -->
<g id="node12" class="node">
<title>interact</title>
<path fill="none" stroke="black" d="M193.12,-246C193.12,-246 45.88,-246 45.88,-246 39.88,-246 33.88,-240 33.88,-234 33.88,-234 33.88,-222 33.88,-222 33.88,-216 39.88,-210 45.88,-210 45.88,-210 193.12,-210 193.12,-210 199.12,-210 205.12,-216 205.12,-222 205.12,-222 205.12,-234 205.12,-234 205.12,-240 199.12,-246 193.12,-246"/>
<text text-anchor="middle" x="119.5" y="-230.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Move packet to interaction location,</text>
<text text-anchor="middle" x="119.5" y="-218.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">perform interaction</text>
</g>
<!-- shortestdistance&#45;&gt;interact -->
<g id="edge8" class="edge">
<title>shortestdistance&#45;&gt;interact</title>
<path fill="none" stroke="black" d="M200.12,-315.94C183.48,-297.99 160.39,-273.1 143.19,-254.55"/>
<polygon fill="black" stroke="black" points="145.91,-252.33 136.54,-247.38 140.77,-257.09 145.91,-252.33"/>
<text text-anchor="middle" x="178.75" y="-280.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- inneredge -->
<g id="node6" class="node">
<title>inneredge</title>
<polygon fill="none" stroke="black" points="142.5,-148 68,-116 142.5,-84 217,-116 142.5,-148"/>
<text text-anchor="middle" x="142.5" y="-118.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Crossing into</text>
<text text-anchor="middle" x="142.5" y="-106.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">photosphere?</text>
</g>
<!-- outeredge&#45;&gt;inneredge -->
<g id="edge12" class="edge">
<title>outeredge&#45;&gt;inneredge</title>
<path fill="none" stroke="black" d="M282.95,-206.82C254.34,-188.52 212.06,-161.48 181.36,-141.86"/>
<polygon fill="black" stroke="black" points="183.42,-139.02 173.11,-136.58 179.65,-144.92 183.42,-139.02"/>
<text text-anchor="middle" x="238.75" y="-168.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- spectralcontrib -->
<g id="node13" class="node">
<title>spectralcontrib</title>
<path fill="none" stroke="black" d="M392,-134C392,-134 247,-134 247,-134 241,-134 235,-128 235,-122 235,-122 235,-110 235,-110 235,-104 241,-98 247,-98 247,-98 392,-98 392,-98 398,-98 404,-104 404,-110 404,-110 404,-122 404,-122 404,-128 398,-134 392,-134"/>
<text text-anchor="middle" x="319.5" y="-112.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Determine contribution to spectrum</text>
</g>
<!-- outeredge&#45;&gt;spectralcontrib -->
<g id="edge11" class="edge">
<title>outeredge&#45;&gt;spectralcontrib</title>
<path fill="none" stroke="black" d="M315.91,-196.07C316.62,-180.32 317.49,-161.3 318.19,-145.86"/>
<polygon fill="black" stroke="black" points="321.68,-146.04 318.64,-135.89 314.69,-145.72 321.68,-146.04"/>
<text text-anchor="middle" x="324.38" y="-168.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- crossintoshell -->
<g id="node10" class="node">
<title>crossintoshell</title>
<path fill="none" stroke="black" d="M79,-36C79,-36 12,-36 12,-36 6,-36 0,-30 0,-24 0,-24 0,-12 0,-12 0,-6 6,0 12,0 12,0 79,0 79,0 85,0 91,-6 91,-12 91,-12 91,-24 91,-24 91,-30 85,-36 79,-36"/>
<text text-anchor="middle" x="45.5" y="-20.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Move packet into</text>
<text text-anchor="middle" x="45.5" y="-8.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">next cell</text>
</g>
<!-- inneredge&#45;&gt;crossintoshell -->
<g id="edge14" class="edge">
<title>inneredge&#45;&gt;crossintoshell</title>
<path fill="none" stroke="black" d="M120.49,-93.22C105.77,-78.65 86.37,-59.45 70.98,-44.22"/>
<polygon fill="black" stroke="black" points="73.55,-41.84 63.98,-37.29 68.63,-46.81 73.55,-41.84"/>
<text text-anchor="middle" x="96.75" y="-56.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- terminate -->
<g id="node11" class="node">
<title>terminate</title>
<path fill="none" stroke="black" d="M365,-36C365,-36 274,-36 274,-36 268,-36 262,-30 262,-24 262,-24 262,-12 262,-12 262,-6 268,0 274,0 274,0 365,0 365,0 371,0 377,-6 377,-12 377,-12 377,-24 377,-24 377,-30 371,-36 365,-36"/>
<text text-anchor="middle" x="319.5" y="-20.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Terminate propagation,</text>
<text text-anchor="middle" x="319.5" y="-8.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">discard packet</text>
</g>
<!-- inneredge&#45;&gt;terminate -->
<g id="edge13" class="edge">
<title>inneredge&#45;&gt;terminate</title>
<path fill="none" stroke="black" d="M174.55,-97.62C203.41,-81.96 246.01,-58.86 277.56,-41.75"/>
<polygon fill="black" stroke="black" points="278.93,-44.98 286.06,-37.14 275.6,-38.83 278.93,-44.98"/>
<text text-anchor="middle" x="259.38" y="-56.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- initpacket -->
<g id="node8" class="node">
<title>initpacket</title>
<path fill="none" stroke="black" d="M285.62,-518C285.62,-518 225.38,-518 225.38,-518 219.38,-518 213.38,-512 213.38,-506 213.38,-506 213.38,-494 213.38,-494 213.38,-488 219.38,-482 225.38,-482 225.38,-482 285.62,-482 285.62,-482 291.62,-482 297.62,-488 297.62,-494 297.62,-494 297.62,-506 297.62,-506 297.62,-512 291.62,-518 285.62,-518"/>
<text text-anchor="middle" x="255.5" y="-496.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Initialize packet</text>
</g>
<!-- nextpacket&#45;&gt;initpacket -->
<g id="edge4" class="edge">
<title>nextpacket&#45;&gt;initpacket</title>
<path fill="none" stroke="black" d="M300.22,-554.81C293.19,-546.35 284.57,-535.98 276.78,-526.61"/>
<polygon fill="black" stroke="black" points="279.7,-524.65 270.62,-519.19 274.32,-529.12 279.7,-524.65"/>
</g>
<!-- calculatedistances -->
<g id="node9" class="node">
<title>calculatedistances</title>
<path fill="none" stroke="black" d="M215.5,-445C215.5,-445 91.5,-445 91.5,-445 85.5,-445 79.5,-439 79.5,-433 79.5,-433 79.5,-421 79.5,-421 79.5,-415 85.5,-409 91.5,-409 91.5,-409 215.5,-409 215.5,-409 221.5,-409 227.5,-415 227.5,-421 227.5,-421 227.5,-433 227.5,-433 227.5,-439 221.5,-445 215.5,-445"/>
<text text-anchor="middle" x="153.5" y="-429.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Calculated distances:</text>
<text text-anchor="middle" x="153.5" y="-417.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">to next cell, to next interaction</text>
</g>
<!-- initpacket&#45;&gt;calculatedistances -->
<g id="edge5" class="edge">
<title>initpacket&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M230.55,-481.63C217.71,-472.69 201.85,-461.66 187.87,-451.92"/>
<polygon fill="black" stroke="black" points="190,-449.14 179.79,-446.3 186,-454.89 190,-449.14"/>
</g>
<!-- calculatedistances&#45;&gt;shortestdistance -->
<g id="edge6" class="edge">
<title>calculatedistances&#45;&gt;shortestdistance</title>
<path fill="none" stroke="black" d="M167.26,-408.8C175.3,-398.75 185.72,-385.73 195.27,-373.79"/>
<polygon fill="black" stroke="black" points="197.89,-376.12 201.4,-366.12 192.42,-371.74 197.89,-376.12"/>
</g>
<!-- crossintoshell&#45;&gt;calculatedistances -->
<g id="edge10" class="edge">
<title>crossintoshell&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M36.66,-36.19C27.81,-55.02 15.5,-86.36 15.5,-115 15.5,-341 15.5,-341 15.5,-341 15.5,-371.45 40.16,-391.34 68.63,-404.17"/>
<polygon fill="black" stroke="black" points="67.27,-407.39 77.85,-408 69.96,-400.93 67.27,-407.39"/>
</g>
<!-- terminate&#45;&gt;allpacketsprocessed -->
<g id="edge16" class="edge">
<title>terminate&#45;&gt;allpacketsprocessed</title>
<path fill="none" stroke="black" d="M365.94,-36.38C397.86,-51.68 434.5,-77.42 434.5,-115 434.5,-574 434.5,-574 434.5,-574 434.5,-612.28 396.81,-637.8 363.67,-652.85"/>
<polygon fill="black" stroke="black" points="362.33,-649.62 354.52,-656.77 365.09,-656.05 362.33,-649.62"/>
</g>
<!-- interact&#45;&gt;calculatedistances -->
<g id="edge9" class="edge">
<title>interact&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M118.79,-246.47C118.11,-273.72 118.5,-327.81 129.5,-372 131.71,-380.86 135.28,-390.09 139,-398.35"/>
<polygon fill="black" stroke="black" points="135.76,-399.68 143.23,-407.19 142.07,-396.66 135.76,-399.68"/>
</g>
<!-- spectralcontrib&#45;&gt;terminate -->
<g id="edge15" class="edge">
<title>spectralcontrib&#45;&gt;terminate</title>
<path fill="none" stroke="black" d="M319.5,-97.84C319.5,-83.86 319.5,-63.84 319.5,-47.47"/>
<polygon fill="black" stroke="black" points="323,-47.85 319.5,-37.85 316,-47.85 323,-47.85"/>
</g>
</g>
</svg>
